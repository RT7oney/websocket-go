<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>
        test websocket
    </title>
</head>
<style type="text/css">
div {
    width: 100%;
    height: 100px;
    text-align: center;
    padding-top: 20px;
    border: 1px solid black;
}
</style>

<body>
    消息：
    <div id="content">
    </div>
</body>
<!-- <script src="base64.js"></script> -->
<script type="text/javascript">
if (typeof(WebSocket) == 'undefined') {
    alert('你的浏览器不支持 WebSocket ，推荐使用Google Chrome 或者 Mozilla Firefox');
}
// var base = new Base64();
var user_token = prompt("用户唯一TOKEN", "");
var user_id = prompt("用户的Member_id", "");
var user_app = prompt("用户的访问平台", "");
if (user_token != "" & user_id != "" & user_app != "") {
    var uri = 'ws://127.0.0.1:12345/c?uid=' + user_id + "&token=" + user_token + "&app=" + user_app;
    // var uri = 'ws://10.65.209.164:12345/c?uid=' + user_token;
    var so;
    createSocket(uri);
}else{
    alert("请刷新页面填写完整数据");
}

/**
 * socket建立
 */
function createSocket(uri) {
    so = new WebSocket(uri);
    console.log(so);

    so.onopen = function() {
        if (so.readyState == 1) {
            console.log('===user register===', "客户端连接成功");
        }else{
            console.log('===user register===', "客户端连接失败");
        }
    }

    so.onclose = function() {
        so = false;
    }

    so.onmessage = function(recv_msg) {
        console.log('===recv_msg===', recv_msg);
        // var decodeStr = Base64.decode(recv_msg.data);
        // console.log('recv_msg.data------' + decodeStr);
    }
}
</script>

</html>
